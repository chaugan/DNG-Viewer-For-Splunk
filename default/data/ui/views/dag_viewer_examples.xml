<dashboard version="1.0.0">
    <label>Examples - Classic</label>
    <description>Comprehensive examples of DOT and Structured data modes</description>
    
    <!-- DOT MODE EXAMPLES -->
    <row>
        <panel>
            <html>
                <h2 style="color: #0072C6; border-bottom: 2px solid #0072C6; padding-bottom: 8px;">DOT Format Examples</h2>
                <p>These examples use the <code>dot</code> field with raw GraphViz DOT syntax.</p>
            </html>
        </panel>
    </row>
    
    <!-- DOT: Simple Graph -->
    <row>
        <panel>
            <title>DOT Mode: Simple Graph (Easy)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults count=1
| eval dot="digraph {
    A -> B -> C;
}"</query>
                </search>
                <option name="height">200</option>
            </viz>
        </panel>
        <panel>
            <title>DOT Mode: Styled Workflow (Easy)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults count=1
| eval dot="digraph {
    rankdir=\"LR\";
    node [shape=\"box\" style=\"filled\" fillcolor=\"#E3F2FD\"];
    
    Start [fillcolor=\"#4CAF50\" fontcolor=\"white\"];
    Process1 [label=\"Process 1\"];
    Process2 [label=\"Process 2\"];
    End [fillcolor=\"#2196F3\" fontcolor=\"white\"];
    
    Start -> Process1 -> Process2 -> End;
}"</query>
                </search>
                <option name="height">200</option>
            </viz>
        </panel>
    </row>
    
    <!-- DOT: Decision Flow -->
    <row>
        <panel>
            <title>DOT Mode: Decision Flow (Medium)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults count=1
| eval dot="digraph {
    rankdir=\"TB\";
    node [shape=\"box\" style=\"filled, rounded\" fillcolor=\"#f5f5f5\"];
    
    Start [shape=\"ellipse\" fillcolor=\"#4CAF50\" fontcolor=\"white\"];
    Decision [shape=\"diamond\" fillcolor=\"#FFC107\" label=\"Decision?\"];
    YesPath [label=\"Yes Path\" fillcolor=\"#E3F2FD\"];
    NoPath [label=\"No Path\" fillcolor=\"#FFEBEE\"];
    Merge [label=\"Merge\"];
    End [shape=\"ellipse\" fillcolor=\"#F44336\" fontcolor=\"white\"];
    
    Start -> Decision;
    Decision -> YesPath [label=\"Yes\"];
    Decision -> NoPath [label=\"No\"];
    YesPath -> Merge;
    NoPath -> Merge;
    Merge -> End;
}"</query>
                </search>
                <option name="height">350</option>
            </viz>
        </panel>
        <panel>
            <title>DOT Mode: Parallel Processing (Medium)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults count=1
| eval dot="digraph {
    rankdir=\"TB\";
    node [shape=\"box\" style=\"filled\" fillcolor=\"#E8F5E9\"];
    edge [color=\"#388E3C\"];
    
    Input [label=\"Data Input\" fillcolor=\"#2196F3\" fontcolor=\"white\"];
    
    Split [label=\"Split\" fillcolor=\"#FFC107\"];
    
    Worker1 [label=\"Worker 1\"];
    Worker2 [label=\"Worker 2\"];
    Worker3 [label=\"Worker 3\"];
    
    Aggregate [label=\"Aggregate\" fillcolor=\"#FFC107\"];
    Output [label=\"Output\" fillcolor=\"#4CAF50\" fontcolor=\"white\"];
    
    Input -> Split;
    Split -> Worker1;
    Split -> Worker2;
    Split -> Worker3;
    Worker1 -> Aggregate;
    Worker2 -> Aggregate;
    Worker3 -> Aggregate;
    Aggregate -> Output;
}"</query>
                </search>
                <option name="height">350</option>
            </viz>
        </panel>
    </row>
    
    <!-- DOT: Complex Attack Tree -->
    <row>
        <panel>
            <title>DOT Mode: Attack Tree (Complex)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults count=1
| eval dot="digraph {
    rankdir=\"TB\";
    splines=true;
    overlap=false;
    nodesep=\"0.3\";
    ranksep=\"0.5\";
    
    node [shape=\"box\" style=\"filled, rounded\" fontname=\"Arial\"];
    edge [fontname=\"Arial\" color=\"#2B303A\"];
    
    // Root
    Goal [label=\"Access\\nSensitive Data\" fillcolor=\"#DB2955\" fontcolor=\"white\"];
    
    // Level 1 - Attack vectors
    Phishing [label=\"Phishing\\nAttack\" fillcolor=\"#ED96AC\"];
    Exploit [label=\"Exploit\\nVulnerability\" fillcolor=\"#ED96AC\"];
    Insider [label=\"Insider\\nThreat\" fillcolor=\"#ED96AC\"];
    
    // Level 2 - Defenses
    Training [label=\"Security\\nTraining\" fillcolor=\"#ABD2FA\"];
    MFA [label=\"Multi-Factor\\nAuth\" fillcolor=\"#ABD2FA\"];
    Patching [label=\"Regular\\nPatching\" fillcolor=\"#ABD2FA\"];
    IDS [label=\"Intrusion\\nDetection\" fillcolor=\"#ABD2FA\"];
    AccessCtrl [label=\"Access\\nControls\" fillcolor=\"#ABD2FA\"];
    Audit [label=\"Audit\\nLogs\" fillcolor=\"#ABD2FA\"];
    
    // Level 3 - Bypasses
    Spearphish [label=\"Targeted\\nSpearphish\" fillcolor=\"#C6CCD2\"];
    ZeroDay [label=\"Zero-Day\\nExploit\" fillcolor=\"#C6CCD2\"];
    SocialEng [label=\"Social\\nEngineering\" fillcolor=\"#C6CCD2\"];
    
    // Edges
    Goal -> Phishing;
    Goal -> Exploit;
    Goal -> Insider;
    
    Phishing -> Training;
    Phishing -> MFA;
    
    Exploit -> Patching;
    Exploit -> IDS;
    
    Insider -> AccessCtrl;
    Insider -> Audit;
    
    Training -> Spearphish [style=\"dashed\" color=\"#7692FF\"];
    MFA -> SocialEng [style=\"dashed\" color=\"#7692FF\"];
    Patching -> ZeroDay [style=\"dashed\" color=\"#7692FF\"];
}"</query>
                </search>
                <option name="height">500</option>
            </viz>
        </panel>
    </row>
    
    <!-- DOT: Network Topology -->
    <row>
        <panel>
            <title>DOT Mode: Network Topology (Complex)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults count=1
| eval dot="digraph {
    rankdir=\"TB\";
    node [shape=\"box\" style=\"filled, rounded\"];
    
    // Internet
    Internet [label=\"Internet\" shape=\"cloud\" fillcolor=\"#E3F2FD\"];
    
    // DMZ
    subgraph cluster_dmz {
        label=\"DMZ\";
        style=\"dashed\";
        Firewall [label=\"Firewall\" fillcolor=\"#F44336\" fontcolor=\"white\"];
        WAF [label=\"WAF\" fillcolor=\"#FF9800\"];
        LoadBalancer [label=\"Load\\nBalancer\" fillcolor=\"#FFC107\"];
    }
    
    // Web Tier
    Web1 [label=\"Web 1\" fillcolor=\"#4CAF50\" fontcolor=\"white\"];
    Web2 [label=\"Web 2\" fillcolor=\"#4CAF50\" fontcolor=\"white\"];
    
    // App Tier  
    App1 [label=\"App 1\" fillcolor=\"#2196F3\" fontcolor=\"white\"];
    App2 [label=\"App 2\" fillcolor=\"#2196F3\" fontcolor=\"white\"];
    
    // Data Tier
    DB_Primary [label=\"DB Primary\" fillcolor=\"#9C27B0\" fontcolor=\"white\"];
    DB_Replica [label=\"DB Replica\" fillcolor=\"#9C27B0\" fontcolor=\"white\"];
    Cache [label=\"Cache\" fillcolor=\"#00BCD4\" fontcolor=\"white\"];
    
    // Connections
    Internet -> Firewall;
    Firewall -> WAF;
    WAF -> LoadBalancer;
    LoadBalancer -> Web1;
    LoadBalancer -> Web2;
    Web1 -> App1;
    Web1 -> App2;
    Web2 -> App1;
    Web2 -> App2;
    App1 -> Cache;
    App2 -> Cache;
    App1 -> DB_Primary;
    App2 -> DB_Primary;
    DB_Primary -> DB_Replica [style=\"dashed\" label=\"Replication\"];
}"</query>
                </search>
                <option name="height">550</option>
            </viz>
        </panel>
    </row>
    
    <!-- STRUCTURED MODE EXAMPLES -->
    <row>
        <panel>
            <html>
                <h2 style="color: #0072C6; border-bottom: 2px solid #0072C6; padding-bottom: 8px; margin-top: 32px;">Structured Data Examples</h2>
                <p>These examples use <code>source</code> and <code>target</code> fields with optional styling.</p>
            </html>
        </panel>
    </row>
    
    <!-- Structured: Basic -->
    <row>
        <panel>
            <title>Structured Mode: Basic Edges (Easy)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults | eval source="A", target="B"
| append [| makeresults | eval source="B", target="C"]
| append [| makeresults | eval source="C", target="D"]
| fields source target</query>
                </search>
                <option name="height">200</option>
            </viz>
        </panel>
        <panel>
            <title>Structured Mode: With Labels (Easy)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults | eval source="Start", target="Step1", label="Begin"
| append [| makeresults | eval source="Step1", target="Step2", label="Process"]
| append [| makeresults | eval source="Step2", target="End", label="Complete"]
| fields source target label</query>
                </search>
                <option name="height">200</option>
            </viz>
        </panel>
    </row>
    
    <!-- Structured: Branching -->
    <row>
        <panel>
            <title>Structured Mode: Branching Flow (Medium)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults | eval source="Input", target="Validate"
| append [| makeresults | eval source="Validate", target="Process_A"]
| append [| makeresults | eval source="Validate", target="Process_B"]
| append [| makeresults | eval source="Process_A", target="Merge"]
| append [| makeresults | eval source="Process_B", target="Merge"]
| append [| makeresults | eval source="Merge", target="Output"]
| fields source target</query>
                </search>
                <option name="height">300</option>
            </viz>
        </panel>
        <panel>
            <title>Structured Mode: With Edge Styling (Medium)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults | eval source="Start", target="Decision", label="init"
| append [| makeresults | eval source="Decision", target="PathA", label="Yes", edge_color="#4CAF50"]
| append [| makeresults | eval source="Decision", target="PathB", label="No", edge_color="#F44336"]
| append [| makeresults | eval source="PathA", target="End", edge_style="dashed"]
| append [| makeresults | eval source="PathB", target="End", edge_style="dashed"]
| fields source target label edge_color edge_style</query>
                </search>
                <option name="height">300</option>
            </viz>
        </panel>
    </row>
    
    <!-- Structured: Full Styling -->
    <row>
        <panel>
            <title>Structured Mode: Full Node Styling (Hard)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults | eval source="Origin", target="Defense1", source_color="#2B303A", source_fontcolor="#ffffff", target_color="#ABD2FA"
| append [| makeresults | eval source="Origin", target="Attack1", source_color="#2B303A", source_fontcolor="#ffffff", target_color="#ED96AC"]
| append [| makeresults | eval source="Defense1", target="Attack2", source_color="#ABD2FA", target_color="#ED96AC"]
| append [| makeresults | eval source="Attack1", target="Goal", source_color="#ED96AC", target_color="#DB2955", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="Attack2", target="Goal", source_color="#ED96AC", target_color="#DB2955", target_fontcolor="#ffffff"]
| eval source_style="filled, rounded", target_style="filled, rounded", node_shape="box"
| fields source target source_color source_fontcolor source_style target_color target_fontcolor target_style node_shape</query>
                </search>
                <option name="height">350</option>
            </viz>
        </panel>
    </row>
    
    <!-- Structured: Multi-Level Network -->
    <row>
        <panel>
            <title>Structured Mode: Multi-Level Infrastructure (Hard)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults | eval source="Internet", target="Firewall", source_color="#E3F2FD", target_color="#F44336", target_fontcolor="#ffffff"
| append [| makeresults | eval source="Firewall", target="LB1", source_color="#F44336", source_fontcolor="#ffffff", target_color="#FF9800"]
| append [| makeresults | eval source="Firewall", target="LB2", source_color="#F44336", source_fontcolor="#ffffff", target_color="#FF9800"]
| append [| makeresults | eval source="LB1", target="Web1", source_color="#FF9800", target_color="#4CAF50", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="LB1", target="Web2", source_color="#FF9800", target_color="#4CAF50", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="LB2", target="Web3", source_color="#FF9800", target_color="#4CAF50", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="LB2", target="Web4", source_color="#FF9800", target_color="#4CAF50", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="Web1", target="App1", source_color="#4CAF50", source_fontcolor="#ffffff", target_color="#2196F3", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="Web2", target="App1", source_color="#4CAF50", source_fontcolor="#ffffff", target_color="#2196F3", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="Web3", target="App2", source_color="#4CAF50", source_fontcolor="#ffffff", target_color="#2196F3", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="Web4", target="App2", source_color="#4CAF50", source_fontcolor="#ffffff", target_color="#2196F3", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="App1", target="Cache", source_color="#2196F3", source_fontcolor="#ffffff", target_color="#00BCD4", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="App2", target="Cache", source_color="#2196F3", source_fontcolor="#ffffff", target_color="#00BCD4", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="App1", target="DB_Primary", source_color="#2196F3", source_fontcolor="#ffffff", target_color="#9C27B0", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="App2", target="DB_Primary", source_color="#2196F3", source_fontcolor="#ffffff", target_color="#9C27B0", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="DB_Primary", target="DB_Replica", source_color="#9C27B0", source_fontcolor="#ffffff", target_color="#9C27B0", target_fontcolor="#ffffff", edge_style="dashed", label="Replication"]
| eval source_style="filled, rounded", target_style="filled, rounded", node_shape="box"
| fields source target label source_color source_fontcolor source_style target_color target_fontcolor target_style edge_style node_shape</query>
                </search>
                <option name="height">500</option>
            </viz>
        </panel>
    </row>
    
    <!-- Structured: Attack Tree -->
    <row>
        <panel>
            <title>Structured Mode: Complete Attack Tree (Hard)</title>
            <viz type="viz_dag_viewer.dag_viewer">
                <search>
                    <query>| makeresults | eval source="Reality", target="Defense_Crawl", source_color="#2B303A", source_fontcolor="#ffffff", target_color="#ABD2FA"
| append [| makeresults | eval source="Reality", target="Defense_Auth", source_color="#2B303A", source_fontcolor="#ffffff", target_color="#ABD2FA"]
| append [| makeresults | eval source="Reality", target="Attack_Cache", source_color="#2B303A", source_fontcolor="#ffffff", target_color="#C6CCD2", label="#yolosec", edge_color="#DB2955"]
| append [| makeresults | eval source="Attack_Cache", target="WIN", source_color="#C6CCD2", target_color="#DB2955", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="Defense_Crawl", target="Attack_S3Search", source_color="#ABD2FA", target_color="#ED96AC"]
| append [| makeresults | eval source="Attack_S3Search", target="Attack_Public", source_color="#ED96AC", target_color="#C6CCD2", label="#yolosec", edge_color="#DB2955"]
| append [| makeresults | eval source="Attack_Public", target="WIN", source_color="#C6CCD2", target_color="#DB2955", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="Defense_Auth", target="Attack_Brute", source_color="#ABD2FA", target_color="#ED96AC"]
| append [| makeresults | eval source="Defense_Auth", target="Attack_Phish", source_color="#ABD2FA", target_color="#ED96AC"]
| append [| makeresults | eval source="Attack_Brute", target="Attack_Creds", source_color="#ED96AC", target_color="#ED96AC"]
| append [| makeresults | eval source="Attack_Phish", target="Attack_Creds", source_color="#ED96AC", target_color="#ED96AC"]
| append [| makeresults | eval source="Attack_Creds", target="Attack_Subsys", source_color="#ED96AC", target_color="#C6CCD2"]
| append [| makeresults | eval source="Attack_Subsys", target="WIN", source_color="#C6CCD2", target_color="#DB2955", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="Attack_Subsys", target="Defense_Lock", source_color="#C6CCD2", target_color="#ABD2FA"]
| append [| makeresults | eval source="Defense_Lock", target="Attack_Misconfig", source_color="#ABD2FA", target_color="#ED96AC"]
| append [| makeresults | eval source="Attack_Misconfig", target="WIN", source_color="#ED96AC", target_color="#DB2955", target_fontcolor="#ffffff"]
| append [| makeresults | eval source="Attack_Misconfig", target="Defense_Server", source_color="#ED96AC", target_color="#ABD2FA"]
| append [| makeresults | eval source="Defense_Server", target="Attack_Phish", source_color="#ABD2FA", target_color="#ED96AC", edge_style="dashed", edge_color="#7692FF"]
| append [| makeresults | eval source="Attack_Phish", target="Attack_Admin", source_color="#ED96AC", target_color="#ED96AC"]
| append [| makeresults | eval source="Attack_Admin", target="Defense_2FA", source_color="#ED96AC", target_color="#ABD2FA"]
| append [| makeresults | eval source="Defense_2FA", target="Attack_2FA", source_color="#ABD2FA", target_color="#ED96AC"]
| append [| makeresults | eval source="Attack_2FA", target="Attack_SSH", source_color="#ED96AC", target_color="#ED96AC"]
| append [| makeresults | eval source="Attack_SSH", target="Defense_IP", source_color="#ED96AC", target_color="#ABD2FA"]
| append [| makeresults | eval source="Defense_IP", target="Attack_Lateral", source_color="#ABD2FA", target_color="#ED96AC"]
| append [| makeresults | eval source="Attack_Lateral", target="WIN", source_color="#ED96AC", target_color="#DB2955", target_fontcolor="#ffffff"]
| eval source_style="filled, rounded", target_style="filled, rounded", node_shape="box"
| fields source target label source_color source_fontcolor source_style target_color target_fontcolor target_style edge_style edge_color node_shape</query>
                </search>
                <option name="height">600</option>
            </viz>
        </panel>
    </row>
    
    <!-- Tips -->
    <row>
        <panel>
            <html>
                <div style="background: #e7f3ff; border-left: 4px solid #0072C6; padding: 16px; margin-top: 24px;">
                    <h3 style="margin-top: 0;">Tips for Building Your Own Graphs</h3>
                    <ul>
                        <li><strong>DOT Mode:</strong> Best for static, complex graphs where you need full control over layout and styling.</li>
                        <li><strong>Structured Mode:</strong> Best for dynamic data from Splunk searches where nodes/edges are generated from events.</li>
                        <li>Use the <strong>Reset View</strong> button to reset zoom after panning.</li>
                        <li>Formatter options are overridden by values in the DOT string.</li>
                        <li>Node IDs should be unique - duplicate IDs will merge into a single node.</li>
                    </ul>
                    <p><a href="dag_viewer_info">‚Üê Back to Documentation</a></p>
                </div>
            </html>
        </panel>
    </row>
</dashboard>

